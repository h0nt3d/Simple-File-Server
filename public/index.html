<!DOCTYPE html>
<html lang="en">
<head>
	<title>File Server</title>
	<style>
		body {
			background-color: black;
		}
		title {
			color: white;
			font-family: "Arial", "sans-serif";
		}
		h1 {
			color: white;
			font-family: "Arial", "sans-serif";
		}	
		ul {
			color: white;
			font-family: "Arial", "sans-serif";
		}
		form {
			color: white;
		}
		.download-btn {
			padding: 5px;
			margin-left: 150px;
			color: red;
			border: none;
			cursor: pointer;
		}
		.upload-btn {
			font-family: "Arial", "sans-serif";
			padding: 20px;	
			vertical-align: baseline;
		}
	</style>
</head>
<body>
	<h1>FILES</h1>
	<h2>Upload File</h2>
	<form id="upload-form" enctype="multipart/form-data" method="post">
		<input type="file" name="file" id="file-input" required />
		<button type="submit" class="upload-btn">Upload</button>
	</form>
	<ul id="file-list"></ul>
	<script>
		function loadFileList() {
			fetch("/files")
			.then(response => response.json())
			.then(files => {
				const fileList = document.getElementById("file-list");
				files.forEach(file => {
					const li = document.createElement("li")
					const fileText = document.createTextNode(file);
					li.appendChild(fileText);
					
					const downloadButton = document.createElement("button");
					downloadButton.className = "download-btn";
					downloadButton.textContent = "Download";

					downloadButton.onclick = function() {
						window.location.href = "/files/" + file;
					}
					li.appendChild(downloadButton);
					fileList.appendChild(li);
				});
			})
			.catch(error => {
				console.eror("Error fetching file list: ", error);
			});
		}
		document.getElementById("upload-form").addEventListener("submit", function(e){
			e.preventDefault();
			const fileInput = document.getElementById("file-input");
			fileInput.className = "upload-btn";
			const file = fileInput.files[0];
			
			const formData = new FormData();
			formData.append("file", file);
			
			fetch("/upload", {
				method: "POST",
				body: formData
			})
			.then(res => res.text())
			.then(msg => {
				alert(msg);
			})
			.catch(error => alert("Upload Failed: " + error));
		});
		window.onload = function() {
			loadFileList();
		}
	</script>
</body>
</html>
